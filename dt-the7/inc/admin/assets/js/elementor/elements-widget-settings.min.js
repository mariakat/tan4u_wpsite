!function(e){e((function(){function t(e,t){return window.the7ElementorSettingsCache[e]||(window.the7ElementorSettingsCache[e]={}),void 0!==t?window.the7ElementorSettingsCache[e][t]:window.the7ElementorSettingsCache[e]}function n(e,t,n){window.the7ElementorSettingsCache[e]||(window.the7ElementorSettingsCache[e]={}),window.the7ElementorSettingsCache[e][t]=n}function o(e,n){var o=t(e,"terms"),i=[];return o[n]&&(i=o[n]),i}function i(e,n){var o=t(e,"taxonomies"),i=[];return o[n]&&(i=o[n]),i}function a(e,t,n){var o=window.Array.isArray(n)?n:[n];e.prop("disabled",!0),e.empty(),e.append(t.reduce((function(e,t,n){var i="";return-1!==o.indexOf(t.value)&&(i="selected"),e+'<option value="'+t.value+'"'+i+">"+t.label+"</option>"}),"")),e.prop("disabled",!1)}function r(e,t,n){var r=e.attributes.widgetType;a(t,o(r,e.getSetting("taxonomy")),e.getSetting("terms")),a(n,i(r,e.getSetting("post_type")),e.getSetting("taxonomy"))}function l(t,n){t.attributes.panel&&-1!==["content_section","query_section"].indexOf(t.attributes.panel.activeSection)&&setTimeout((function(t,n){var l=n.$el.find("[data-setting='post_type']"),s=n.$el.find("[data-setting='taxonomy']"),c=n.$el.find("[data-setting='terms']");r(t,c,s),l.on("change",(function(){var n=i(t.attributes.widgetType,e(this).val());n[0]&&(a(s,n,null),t.setSetting(n[0].value),s.trigger("change"))})),s.on("change",(function(){var n=t.attributes.widgetType;c[0].options.length=0,a(c,o(n,e(this).val()),null),t.setSetting("terms",[])}))}),350,this.model,this.panel)}void 0===window.the7ElementorSettingsCache&&(window.the7ElementorSettingsCache={}),elementor.hooks.addAction("panel/open_editor/widget",(function(s,c,u){var d=s.$el.find("[data-setting='post_type']"),p=s.$el.find("[data-setting='taxonomy']"),g=s.$el.find("[data-setting='terms']"),m=c.attributes.widgetType;t(m,"taxonomies")&&t(m,"terms")?r(c,g,p):e.post(window.the7ElementsWidget.ajaxurl,{action:"the7_elements_get_widget_taxonomies",post_types:d.find("option").map((function(){return e(this).val()})).get(),_wpnonce:window.the7ElementsWidget._wpnonce}).done((function(e){e||(e={}),n(m,"taxonomies",e.taxonomies),n(m,"terms",e.terms),r(c,g,p)})),d.on("change",(function(){var t=i(c.attributes.widgetType,e(this).val());t[0]&&(a(p,t,null),c.setSetting(t[0].value),p.trigger("change"))})),p.on("change",(function(){var t=c.attributes.widgetType;g[0].options.length=0,a(g,o(t,e(this).val()),null),c.setSetting("terms",[])})),elementor.channels.editor.off("change:editSettings",l).on("change:editSettings",l,{panel:s,model:c})})),elementor.on("preview:loaded",(function(){elementor.addControlView("the7-query",elementor.modules.controls.Select2.extend({cache:null,isTitlesReceived:!1,getSelect2Placeholder:function(){return{id:"",text:"All"}},getControlValueByName:function(e){var t=this.model.get("group_prefix")+e;return this.container.settings.get(t)},getQueryDataDeprecated:function(){return{filter_type:this.model.get("filter_type"),object_type:this.model.get("object_type"),include_type:this.model.get("include_type"),query:this.model.get("query")}},getQueryData:function(){var e=elementorCommon.helpers.cloneObject(this.model.get("autocomplete"));return _.isEmpty(e.query)&&(e.query={}),"cpt_tax"===e.object&&(e.object="tax",(_.isEmpty(e.query)||_.isEmpty(e.query.post_type))&&(e.query.post_type=this.getControlValueByName("post_type"))),{autocomplete:e}},getSelect2DefaultOptions:function(){var e=this;return jQuery.extend(elementor.modules.controls.Select2.prototype.getSelect2DefaultOptions.apply(this,arguments),{ajax:{transport:function(t,n,o){var i={},a="the7_panel_posts_control_filter_autocomplete";return!_.isEmpty(e.model.get("filter_type"))?(i=e.getQueryDataDeprecated(),a="the7_panel_posts_control_filter_autocomplete_deprecated"):i=e.getQueryData(),i.q=t.data.q,elementorCommon.ajax.addRequest(a,{data:i,success:n,error:o})},data:function(e){return{q:e.term,page:e.page}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1})},getValueTitles:function(){var e=this,t={},n=!_.isEmpty(this.model.get("filter_type")),o=this.getControlValue(),i="the7_query_control_value_titles",a="autocomplete",r={};n?(a="filter_type",r=this.model.get(a).object,t.filter_type=r,t.object_type=e.model.get("object_type"),t.include_type=e.model.get("include_type"),t.unique_id=""+e.cid+r,i="the7_query_control_value_titles_deprecated"):(r=this.model.get(a).object,t.get_titles=e.getQueryData().autocomplete,t.unique_id=""+e.cid+r),o&&r&&(_.isArray(o)||(o=[o]),elementorCommon.ajax.loadObjects({action:i,ids:o,data:t,before:function(){e.addControlSpinner()},success:function(t){e.isTitlesReceived=!0,e.model.set("options",t),e.render()}}))},addControlSpinner:function(){this.ui.select.prop("disabled",!0),this.$el.find(".elementor-control-title").after('<span class="elementor-control-spinner">&nbsp;<i class="eicon-spinner eicon-animation-spin"></i>&nbsp;</span>')},onReady:function(){this.ui.select.select2(this.getSelect2Options()),this.isTitlesReceived||this.getValueTitles()}}))}))}))}(jQuery);