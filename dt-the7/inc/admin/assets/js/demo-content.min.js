!function(t){"use strict";t((function(){var n,e,o,i=null,a=null,r=t(".the7-import-feedback"),s=t(".dt-dummy-content"),d={feedback:null,beforePluginsInstallation:function(){},onActionStart:function(t){this.feedback=b(t,r)},onActionDone:function(n){this.feedback.replaceWith(t('<p class="the7-updated">'+n+"</p>"))},onActionFail:function(n){this.feedback.replaceWith(t('<p class="the7-error">'+n+"</p>"))}},u={import_attachments:function(t,n){return t.then((function(){var t=b(g(n),r);return v(n,t)}))},install_plugins:function(n,e,o){var i=d,a=o.plugins_to_install,r=o.plugins_to_activate,s=dtDummy.plugins_page_url,u=dtDummy.strings.plugins_installation_error;if(!r&&!a)return n;return i.beforePluginsInstallation(t.merge([],a,r)),a.forEach((function(e){n=n.then((function(){var n=e;return void 0!==dtDummy.plugins[e]&&(n=dtDummy.plugins[e]),i.onActionStart(dtDummy.strings.installing_plugin+" "+n),t.post(s,{action:"tgmpa-bulk-install",just_install:!0,noheader:!0,plugin:e}).then((function(n){var e=t.Deferred();return t(n).find(".update-php div.error p").length>0?e.reject(n):e.resolve(n),e.promise()})).done((function(n){var e=t(n).find(".update-php div.updated p");e.find(".js-update-details-toggle").remove(),i.onActionDone(e.text())})).fail((function(n){var o=t(n).find(".update-php div.error p");i.onActionFail(o.length?o.text():u,e)}))}))})),n=(n=n.then((function(){return i.onActionStart(dtDummy.strings.activating_plugin),t.merge(r,a),t.post(s,{action:"tgmpa-bulk-activate",noheader:!0,plugin:r}).done((function(t){i.onActionDone(dtDummy.strings.plugins_activated)})).fail((function(){i.onActionFail(u)}))}))).then((function(){return i.onActionStart(dtDummy.strings.rid_of_redirects),t.get(s,{noheader:!0}).done((function(){i.onActionDone(dtDummy.strings.rid_of_redirects)})).fail((function(){i.onActionFail(u)}))}))},import_by_url:function(n,e,o){return h(n,t.extend({},e,{provided_url:o.provided_url}))},import_one_post:function(n,e,o){return h(n,t.extend({},e,{post_to_import:o.post_to_import}))},remove_content:function(t,n,e){return f(t,{action:"the7_remove_demo_content",_wpnonce:dtDummy.remove_demo_nonce,demo:e.demo_id,dummy:"remove_content"}).always(w)},keep_content:function(t,n,e){return f(t,{action:"the7_keep_demo_content",_wpnonce:dtDummy.nonces.keep_demo_content,demo:e.demo_id,dummy:"keep_content"}).always(w)},cleanup:function(t,n,e){return f(t,n).always(w)}},p=(new(function(){function n(n,e){this.insertAfterObj=t(e),this.noticeID=n,this.noticeTplObj=t('<div id="'+n+'" class="the7-dashboard-notice the7-notice notice is-dismissible"></div>'),t("body").on("click","#"+n+" .notice-dismiss",(function(){t("#"+n).remove()}))}return n.prototype.addError=function(n,e){if(!n)return t();t("html, body").animate({scrollTop:0},400);return this.noticeTplObj.clone().html(n+'<button type="button" class="notice-dismiss"><span class="screen-reader-text">Dismiss this notice.</span></button>').addClass(e).insertAfter(this.insertAfterObj)},n.prototype.removeErrors=function(){t("#"+this.noticeID).remove()},n.prototype.prepareMsg=function(t){return"<p><strong>"+t+"</strong></p>"},n.prototype.addMsg=function(t,n){return this.addError(this.prepareMsg(t),n)},n}())("the7-demo-content-error",".wrap > .wp-header-end"),{bootstrap:function(){var n=this;t(".nav-tab-wrapper").show(),this.showOptionsTab(t(".nav-tab-wrapper a.nav-tab-active").attr("id")),t(".tabs-holder").removeClass("hidden"),t(".nav-tab-wrapper a").on("click.the7.tabs",(function(t){n.onTabClick(t,this)})),t(window).on("popstate.the7.tabs",this.onPopstate.bind(this))},convertTab2Group:function(t){return t.replace("-tab","-group")},showOptionsTab:function(n){if(n){var e=this.convertTab2Group(n);t(".group").hide().filter("#"+e).fadeIn(),t(".nav-tab-wrapper a").removeClass("nav-tab-active").filter("#"+n).addClass("nav-tab-active").blur()}},onTabClick:function(n,e){n.preventDefault();var o=t(e);if(o.hasClass("blocked"))return!1;var i=o.attr("id");return this.showOptionsTab(i),history.pushState({activeGroupId:"#"+this.convertTab2Group(i)},"",o.attr("href")),!1},onPopstate:function(n){var e={};if(location.search.substr(1).split("&").forEach((function(t){e[t.split("=")[0]]=t.split("=")[1]})),e.tab)var o=e.tab;else o=t(".nav-tab-wrapper a").first().attr("id");this.showOptionsTab(o)},blockTabs:function(){t(".nav-tab-wrapper a").removeClass("blocked").addClass("blocked")},unblockTabs:function(){t(".nav-tab-wrapper a").removeClass("blocked")}});function c(t){this.button=t}function m(t){this.container=t}function l(t){this.id=t.attr("data-dummy-id"),this.title=t.find("h3").first().text(),this.url=D(t.find(".dt-dummy-screenshot a").first().attr("href")),this.tags=JSON.parse(t.attr("data-tags")),this.container=t,this.settings=t.find(".dt-dummy-field input"),this.errors=new m(t.find(".the7-demo-notifications")),this.buttons={import:new c(t.find(".dt-dummy-button-import")),onePageImport:new c(t.find(".dt-dummy-button-import-one-page")),remove:new c(t.find(".dt-remove-content-button")),keep:new c(t.find(".dt-keep-content-button"))},this.addEvents()}function f(n,e,o){return n.then((function(){var n=g(e);return void 0===o&&(o=b(n,r)),t.post(ajaxurl,e).then(k).done((function(e){o.replaceWith(t('<p class="the7-updated">'+n+"</p>"))})).fail((function(){o.replaceWith(t('<p class="the7-error">'+n+"</p>"))}))}))}function h(n,e,o){return n.then((function(){var o=g(e),i=b(o,r);return t.post(ajaxurl,e).then(k).done((function(a){var r=a.data.step2Links;return i.replaceWith(t('<p class="the7-updated">'+o+"</p>")),a.data.postImportActions.forEach((function(o){var i=t.extend({},e,{dummy:o,imported_post_id:a.data.imported_post_id});n=u.hasOwnProperty(o)?u[o](n,i,the7ImportData):f(n,i)})),n.done((function(n){t("#the7-demo-visit-site-link").replaceWith(r)})),n})).fail((function(){i.replaceWith(t('<p class="the7-error">'+o+"</p>"))}))}))}function v(n,e){return t.post(ajaxurl,n).then(k).then((function(o){var i,a,r=g({dummy:"import_attachments"})+" ("+o.data.imported+"/"+o.data.total+")";return r===e.text().trim()?k(null):0!=o.data.left?v(n,(i=e,a=b(r),i.replaceWith(a),a)):void e.replaceWith(t('<p class="the7-updated">'+g(n)+"</p>"))})).fail((function(){e.replaceWith(t('<p class="the7-error">'+g(n)+"</p>"))}))}function b(n,e){var o=t('<p><span class="spinner is-active" style="float: none; margin: 0"></span> '+n+"</p>");return void 0!==e&&e.append(o),o}function _(n,e){var o=e.find("select.dt-dummy-content-posts");o.empty(),t.each(i[n],(function(t,n){o.append('<option id="'+t+'"  value="'+t+'">'+n.post_title+"</option>")})),y(e)}function y(t){var n=t.find("select.dt-dummy-content-posts").val(),e=t.find("select.dt-dummy-content-post-type").val(),o=t.find(".dt-dummy-one-post-url");null!=n&&null!=e?(o.attr("href",i[e][n].url),o.show()):o.hide()}function g(t){var n=t.dummy;return void 0!==dtDummy.strings[t.dummy]&&(n=dtDummy.strings[t.dummy]),n}function D(t){return"https://"+t.replace(/[\?#].*/,"").replace(/\/?$/,"/").replace("https://","")}function w(){t(".the7-go-back-link").removeClass("hide-if-js")}function k(n){var e=t.Deferred();return n.success?e.resolve(n):e.reject(n),e.promise()}p.bootstrap(),"undefined"!=typeof the7ImportData&&(e=the7ImportData.actions,o=t.when(),e.forEach((function(t){var n={action:"the7_import_demo_content",dummy:t,content_part_id:the7ImportData.demo_id,user_map:the7ImportData.users,imported_authors:["admin"],_wpnonce:dtDummy.import_nonce,import_type:the7ImportData.import_type||"full_import"};o=u.hasOwnProperty(t)?u[t](o,n,the7ImportData):f(o,n)})),o.fail((function(n){var e=new m(r);void 0!==n.data&&void 0!==n.data.error_msg&&n.data.error_msg?e.addText(n.data.error_msg):e.addPHPStatus(),t(".the7-go-back-link").html(dtDummy.strings.go_back_with_error),w()}))),t(".dt-dummy-control-buttons .dt-dummy-button-import-one-page").on("click",(function(e){var o,r,s=t(this),d=s.closest(".dt-dummy-content"),u=d.data("the7Demo"),c=[t(".dt-dummy-content-user",d).first().val()],m=t.when();e.preventDefault(),u.errors.clear(),u.buttons.onePageImport.setBusy(dtDummy.strings.loading),o=t("#full-site-group"),r=o.find("button").not(":disabled"),o.data("the7ButtonsToEnable",r),r.prop("disabled","disabled"),p.blockTabs(),function(t,e){var o=t.attr("data-dummy-id")||"0";void 0===n||o===a&&!e||(n.slideDown(),n.parent().find(".dt-dummy-one-page-importing-interface").remove());a=o}(d,!1),["download_package","get_posts"].forEach((function(t){m=f(m,{action:"the7_import_demo_content",_wpnonce:dtDummy.import_nonce,dummy:t,user_map:c,content_part_id:u.id})})),m.done((function(e){void 0!==e.data&&void 0!==e.data.response&&"getPostsList"===e.data.response&&(i=e.data.data,(n=s.closest(".dt-dummy-controls-block-import-one-page")).slideUp(400,(function(){var e=t('<div class="dt-dummy-one-page-importing-interface"></div>');n.after(e),function(t){t.empty(),t.hide();var n='<div class="dt-dummy-controls-block" style="padding-bottom: 1em;"><table class="dt-dummy-field dt-dummy-one-post-data"><tr><td>'+dtDummy.strings.one_post_importing_choose_posttype+': </td><td><select name="the7_import_post_type" id="post-type" class="dt-dummy-content-post-type"></select></td></tr><tr><td>'+dtDummy.strings.one_post_importing_choose_post+': </td><td><select name="the7_import_post_id" id="posts" class="dt-dummy-content-posts"></select> <a class="the7-tip dt-dummy-one-post-url" href="#" target="_blank">'+dtDummy.strings.one_post_importing_url_msg+"</a></td></tr></table></div>",e='<div class="dt-dummy-controls-block dt-dummy-control-buttons"><div class="dt-dummy-button-wrap"><button type="submit" class="button button-primary dt-dummy-button-import-one-page-submit">'+dtDummy.strings.one_post_importing_import+"</button></div></div>";void 0!==t&&(t.append(n),t.append(e))}(e),function(n){var e=n.find("select.dt-dummy-content-post-type");e.html(""),t.each(i,(function(t,n){e.append('<option id="'+t+'"  value="'+t+'">'+t+"</option>")})),y(n)}(e),e.slideDown(),_(e.find("select.dt-dummy-content-post-type").val(),e),e.find("select.dt-dummy-content-post-type").on("change",(function(t){_(this.value,e)})),e.find("select.dt-dummy-content-posts").on("change",(function(t){y(e)}))})))})),m.fail((function(t){void 0!==t.data&&void 0!==t.data.error_msg&&t.data.error_msg?u.errors.addText(t.data.error_msg):u.errors.addPHPStatus()})),m.always((function(){!function(){var n=t("#full-site-group"),e=n.data("the7ButtonsToEnable");if(n.removeData("the7ButtonsToEnable"),!e||!e.length)return;e.removeAttr("disabled"),p.unblockTabs()}(),u.buttons.onePageImport.setFree()}))})),t(".the7-demo-quick-search .the7-demo-tag").on("click",(function(){var n=t(this).attr("data-tag"),e=t("#dt-dummy-search-input");e.val(e.val()+" "+n+" ").trigger("search").focus()})),t("#dt-dummy-search-input").on("search keyup",(function(){var n=t(this).val().toLowerCase(),e=n.split(" ");1!==n.length&&s.filter((function(t,n){return!0})).each((function(){var o=t(this),i=o.data("the7Demo"),a=!1,r=i.title.toLowerCase()+" "+i.tags.join(" ").toLowerCase();(e.every((function(t){return r.includes(t)}))||i.url.toLowerCase().includes(D(n)))&&(a=!0),a?o.show():o.hide()}))})),t(".dt-remove-content-button").on("click",(function(t){window.confirm(dtDummy.strings.remove_content_confirm)||t.preventDefault()})),t(".dt-keep-content-button").on("click",(function(t){window.confirm(dtDummy.strings.keep_content_confirm)||t.preventDefault()})),c.prototype.disable=function(){this.button.prop("disabled",!0)},c.prototype.enable=function(){this.button.prop("disabled",!1)},c.prototype.setBusy=function(t){this.setFree(),this.button.addClass("button--importing").prop("disabled",!0),void 0!==t&&(this.button.data("the7ButtonOriginCaption",this.button.text()),this.button.text(t)),this.button.siblings(".spinner").first().addClass("is-active")},c.prototype.setFree=function(t){var n=this.button.data("the7ButtonOriginCaption");this.button.siblings(".spinner").first().removeClass("is-active"),this.button.removeClass("button--importing").prop("disabled",!1),n&&this.button.text(n)},m.prototype.addText=function(t){this.add("<p>"+t+"</p>")},m.prototype.add=function(n){var e=t('<div class="dt-dummy-inline-msg hide-if-js inline error">'+n+"</div>");this.container.append(e),e.slideDown()},m.prototype.clear=function(){this.container.slideUp().html("")},m.prototype.addPHPStatus=function(){var n=this;t.post(ajaxurl,{action:"the7_demo_content_php_status",_wpnonce:dtDummy.status_nonce}).then(k).done((function(t){t.data?n.add(t.data):n.addText(dtDummy.strings.msg_import_fail)})).fail((function(){n.addText(dtDummy.strings.msg_import_fail)}))},l.prototype.addEvents=function(){var n=this;this.settings.on("change",(function(){var e=t(this),o=e.data("affectedSettings")||n.container.find(".dt-dummy-field :input").not("[name=install_plugins], [name=import_theme_options], :disabled");"install_plugins"===e.attr("name")&&(e.data("affectedSettings",o),e.is(":checked")?(o.removeAttr("disabled").parents(".dt-dummy-field").removeClass("disabled"),e.removeData("affectedSettings")):o.attr("disabled","disabled").parents(".dt-dummy-field").addClass("disabled")),n.maybeChangeImportButtonState()}))},l.prototype.getActions=function(){var n=[];return this.settings.filter(":checked").not(":disabled").each((function(){n.push(t(this).attr("name"))})),n.indexOf("import_theme_options")>=0&&(n=n.filter((function(t){return"import_theme_options"!==t}))).push("import_theme_options"),n},l.prototype.maybeChangeImportButtonState=function(){this.getActions().filter((function(t){return"install_plugins"!==t})).length?this.buttons.import.enable():this.buttons.import.disable()},s.each((function(){var n=t(this);n.data("the7Demo",new l(n))}))}))}(jQuery);