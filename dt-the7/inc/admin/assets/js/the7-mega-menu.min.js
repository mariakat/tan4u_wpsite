"use strict";jQuery((function(e){var t={tb_icon_bar_open:!1,tb_unload_binded:!1,origin_tb_position:null,appendToBottom:"",init:function(e){this.appendToBottom=e||"",this.extendTBPosition()},calculateHeight:function(t){return e(window).height()-2*t},openTB:function(e){this.tb_icon_bar_open=!0,tb_show(e,"#TB_inline?width=1024&height=768")},extendTBPosition:function(){var t=this;t.origin_tb_position=window.tb_position,window.tb_position=function(){if(t.tb_icon_bar_open){var n=e("#TB_window"),i=e(window).width(),o=840;o>i&&(o=i-10);var a=e("#TB_title",n).height(),p=e(".the7-mega-menu-popup-bottom-bar",n).height(),s=t.calculateHeight(20);n.hasClass("presscore-microwidget-modal")||n.addClass("presscore-microwidget-modal"),t.tb_unload_binded||(t.tb_unload_binded=!0,e("#TB_ajaxContent",n).wrapInner('<div class="the7-mega-menu-popup-content"></div>'),n.append('<div class="the7-mega-menu-popup-bottom-bar">'+t.appendToBottom+"</div>"),p=e(".the7-mega-menu-popup-bottom-bar",n).height()+10,n.on("tb_unload",(function(){t.tb_icon_bar_open=!1,t.tb_unload_binded=!1,e(window).off("resize.the7MegaMenu")})),e(window).on("resize.the7MegaMenu",(function(){var i=t.calculateHeight(20);n.height(i),e(".the7-mega-menu-popup-content",n).height(i-a-p)}))),n.size()&&(n.width(o).height(s),e("#TB_ajaxContent",n).removeAttr("style"),n.css({left:parseInt((i-o)/2,10)+"px"}),void 0!==document.body.style.maxWidth&&n.css({top:"20px","margin-top":"0"}),e(".the7-mega-menu-popup-content",n).height(s-a-p))}else t.origin_tb_position()}}};t.init(the7MegaMenuTemplates.popupBottomBar),e("body").on("click.the7MegaMenu",".optionsframework-submit > .button-primary",(function(t){t.preventDefault();var n=e(this).parents("#TB_window").find(".the7-mega-menu-popup-content"),i=n.data("the7SettingsStorageElement"),o={};e("input, textarea, select",n).serializeArray().forEach((function(e){for(var t,n=e.name.split("[").slice(1).map((function(e){return e.replace("]","")})),i=o,a=n.length-1,p=0;p<=a;p++)void 0===i[t=n[p]]&&(i[t]=p===a?e.value:{}),i=i[t]})),i.val(JSON.stringify(o)),tb_remove()})),e("#menu-to-edit .field-description").after(the7MegaMenuTemplates.megaMenuButton),e(document).on("menu-item-added",(function(e,t){t.find(".field-description").after(the7MegaMenuTemplates.megaMenuButton)})),e("#post-body").on("click",".the7-options-tb-popup",(function(n){n.preventDefault(),t.openTB(the7MegaMenuTemplates.popupTitle);var i=e(this).closest(".menu-item"),o=e(".the7-mega-menu-popup-content");o.empty().html('<span class="spinner is-active" style="float: none; position: absolute; top: 50%; left: calc(50% - 20px)"></span>');var a=i.attr("class").replace(/.*menu-item-depth-([0-9]).*/,"$1"),p="",s="",m=0;if(a>0){var r=i.attr("id"),u=null;e("#menu-to-edit .menu-item").each((function(){var t=e(this);if(t.hasClass("menu-item-depth-0")&&(u=t),t.attr("id")===r){if(u){var n=u.find(".the7-mega-menu-settings");if(n.length&&n.val()){var i=JSON.parse(n.val());p=i["mega-menu"],s=i["mega-menu-elementor"]}m=u.find(".menu-item-data-db-id").val()}return!1}}))}var d=i.find(".the7-mega-menu-settings").val()||"",l=i.find(".menu-item-data-db-id").val();e.post(ajaxurl,{action:"the7_render_mega_menu_settings",item_id:l,item_settings:d,item_depth:a,parent_id:m,parent_mega_menu:p,parent_mega_menu_elementor:s}).done((function(t){o.html(t);var n=i.find(".the7-mega-menu-settings");n.length||(n=e(the7MegaMenuTemplates.itemSettingsStorageElement.replace("%itemID%",l)).appendTo(i.find(".menu-item-settings"))),o.data("the7SettingsStorageElement",n),"function"==typeof window.the7OptionsBootstrap&&window.the7OptionsBootstrap(),"function"==typeof window.optionsframework_file_bindings&&window.optionsframework_file_bindings()}))}))}));