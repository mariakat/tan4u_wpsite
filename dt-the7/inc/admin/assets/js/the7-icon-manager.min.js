!function(e){"use strict";var o={wp_media:[],init:function(){var t=e("body");t.on("click",".the7_upload_icon",o.openMediaPopup),t.on("the7_icon_manager_insert",o.insertIcon),t.on("click",".the7_del_icon",o.removeIcon),t.on("click",".the7_add_fontawesome",o.addFontAwesome),t.on("click",".the7-add-ua-default-font",o.addUADefaultIcons)},openMediaPopup:function(t){t.preventDefault();var n=e(this).data();n.input_target=e("#"+n.target);var r=wp.media({frame:n.frame,library:{type:n.type},button:{text:n.button},className:n.class});r.on("select update insert",(function(){o.mediaPopupOnInsert(r,n)})),r.open()},mediaPopupOnInsert:function(o,t){var n=o.state().get("selection").first().toJSON();t.input_target.val(n.id).trigger("change"),e("body").trigger(t.trigger,[n,t])},insertIcon:function(t,n,r){r.input_target.val("");var a=o;if("zip"!==n.subtype&&"x-zip"!==n.subtype)return a._hideSpinner(),void a._showErrorNotice(the7IconManagerLocal.text.error.invalid_file_format);e.ajax({type:"POST",url:ajaxurl,data:{action:"the7_icons_manager_add_zipped_font",security:the7IconManagerLocal.nonces.add_zipped_font,values:n},beforeSend:function(){a._showSpinner()},error:function(){a._showErrorNotice(the7IconManagerLocal.text.error.server_error)},success:function(e){e.match(/the7_icon_font_added/)?(a._showSuccessNotice(the7IconManagerLocal.text.success.font_added),window.location.reload()):a._showErrorNotice(the7IconManagerLocal.text.error.could_not_add_font+" "+e)},complete:function(){a._hideSpinner()}})},removeIcon:function(t){t.preventDefault();var n=o,r=e(this),a=r.data("delete");e.ajax({type:"POST",url:ajaxurl,data:{action:"the7_icons_manager_remove_zipped_font",del_font:a,security:the7IconManagerLocal.nonces.remove_zipped_font},beforeSend:function(){n._showSpinner()},error:function(){n._showErrorNotice(the7IconManagerLocal.text.error.server_error_while_delete)},success:function(o){o.match(/the7_icon_font_removed/)?r.closest(".metabox-holder").slideUp(400,(function(){e(this).remove(),o.match(/with_reload/)&&window.location.reload()})):n._showErrorNotice(the7IconManagerLocal.text.error.could_not_remove_font)},complete:function(){n._hideSpinner()}})},addFontAwesome:function(t){t.preventDefault();var n=o,r=e(this).attr("data-fa-type");e.ajax({type:"POST",url:ajaxurl,data:{action:"the7_icons_manager_add_font_awesome",type:r,security:the7IconManagerLocal.nonces.add_add_font_awesome},beforeSend:function(){n._showSpinner()},error:function(){n._showErrorNotice(the7IconManagerLocal.text.error.server_error)},success:function(e){e.match(/the7_icon_font_added/)?(n._showSuccessNotice(the7IconManagerLocal.text.success.font_added),window.location.reload()):n._showErrorNotice(the7IconManagerLocal.text.error.could_not_add_font+" "+e)},complete:function(){n._hideSpinner()}})},addUADefaultIcons:function(t){t.preventDefault();var n=o;e.ajax({type:"POST",url:ajaxurl,data:{action:"the7_icons_manager_add_ua_default_icons",security:the7IconManagerLocal.nonces.add_add_ua_default_icons},beforeSend:function(){n._showSpinner()},error:function(){n._showErrorNotice(the7IconManagerLocal.text.error.server_error)},success:function(e){e.match(/the7_icon_font_added/)?(n._showSuccessNotice(the7IconManagerLocal.text.success.font_added),window.location.reload()):n._showErrorNotice(the7IconManagerLocal.text.error.could_not_add_font+" "+e)},complete:function(){n._hideSpinner()}})},_showSpinner:function(){e(".spinner").css({opacity:0,display:"block",visibility:"visible",position:"absolute",top:"21px",left:"345px"}).animate({opacity:1})},_hideSpinner:function(){e(".spinner").hide()},_showNotice:function(o,t){var n=e("#msg");t=t||"error",n.html('<div class="'+t+'"><p>'+o+"</p></div>"),n.show(),setTimeout((function(){n.slideUp()}),5e3)},_showErrorNotice:function(e){this._showNotice(e,"error")},_showSuccessNotice:function(e){this._showNotice(e,"updated")}};e((function(){o.init()}))}(jQuery);